# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2023-05-10 16:03:26
"""
import arcpy

def Model():  # Model

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    Wells_In_Buffer = "Wells_In_Buffer"

    # Process: Export Table - Well_Type (Export Table) (conversion)
    Well_Type = "D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Well_Type"
    arcpy.conversion.ExportTable(in_table=Wells_In_Buffer, out_table=Well_Type, field_mapping="WELL_ID \"WELL_ID\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\.\\CollabProj.gdb\\Wells_In_Buffer,WELL_ID,0,255;TAG \"TAG\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\.\\CollabProj.gdb\\Wells_In_Buffer,TAG,0,255;EAST83 \"EAST83\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\.\\CollabProj.gdb\\Wells_In_Buffer,EAST83,0,255;NORTH83 \"NORTH83\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\.\\CollabProj.gdb\\Wells_In_Buffer,NORTH83,0,255;UTMZONE \"UTMZONE\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\.\\CollabProj.gdb\\Wells_In_Buffer,UTMZONE,0,255;WELL_COMPLETED_DATE \"WELL_COMPLETED_DATE\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\.\\CollabProj.gdb\\Wells_In_Buffer,WELL_COMPLETED_DATE,0,255;RECEIVED_DATE \"RECEIVED_DATE\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\.\\CollabProj.gdb\\Wells_In_Buffer,RECEIVED_DATE,0,255;FINAL_STATUS_DESCR \"FINAL_STATUS_DESCR\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\.\\CollabProj.gdb\\Wells_In_Buffer,FINAL_STATUS_DESCR,0,255;USE1 \"USE1\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\.\\CollabProj.gdb\\Wells_In_Buffer,USE1,0,255;USE2 \"USE2\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\.\\CollabProj.gdb\\Wells_In_Buffer,USE2,0,255;DEPTH_M \"DEPTH_M\" true true false 8 Double 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\.\\CollabProj.gdb\\Wells_In_Buffer,DEPTH_M,-1,-1;WAT \"WAT\" true true false 300 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\.\\CollabProj.gdb\\Wells_In_Buffer,WAT,0,300;SWL \"SWL\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\.\\CollabProj.gdb\\Wells_In_Buffer,SWL,0,255;PT \"PT\" true true false 300 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\.\\CollabProj.gdb\\Wells_In_Buffer,PT,0,300")

    # Process: Calculate Field - WAT (Calculate Field) (management)
    Well_Type_2_ = arcpy.management.CalculateField(in_table=Well_Type, field="WAT", expression="primary(!WAT!)", code_block="""import re
def primary(waterField):
    def stephen_format(matchobj):
        val = float(matchobj[1])
        if matchobj[2] == \"ft\": 
            val=round((float(matchobj[1])*0.3048),2)
        return str(val) + \" m\" 
    waterField = re.findall('(\\w*;\\s*)([\\d\\.]+)\\s*(ft|m)', waterField)
    waterReturn = str()
    for m in waterField:
        stephen_format(m)
        waterReturn += stephen_format(m) + \"; \"
    return waterReturn""")[0]

    # Process: Calculate Field SWL (Calculate Field) (management)
    Well_Type_3_ = arcpy.management.CalculateField(in_table=Well_Type_2_, field="SWL", expression="statWater(!SWL!)", code_block="""import re
def statWater(waterField):
    def ft2m(conv):
        val = float(conv.group(1))
        print(val)
        if conv.group(2) == " ft": 
            val=round((float(conv.group(1))*0.3048),1)
            return str(val)
        elif conv.group(2) == " m":
            val = round(val,1)
            return str(val)
    converted = re.sub('([\d\.]+)(\s*\w+)',ft2m,waterField)
    return converted""")[0]

if __name__ == '__main__':
    # Global Environment settings
    with arcpy.EnvManager(scratchWorkspace="D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb", workspace="D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb"):
        Model()
