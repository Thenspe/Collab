# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2023-05-11 08:12:52
"""
import arcpy
from sys import argv

def Model(Site_Boundary, Buffer_Distance):  # Model

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    Wells_Report = "Wells_Report"

    # Process: Pairwise Buffer (Pairwise Buffer) (analysis)
    Site_Buffer_Buffer_Distance_ = fr"D:\FlemSem3\Collab\CollabProj\CollabProj.gdb\Site_Buffer_{Buffer_Distance}"
    arcpy.analysis.PairwiseBuffer(in_features=Site_Boundary.__str__().format(**locals(),**globals()), out_feature_class=Site_Buffer_Buffer_Distance_, buffer_distance_or_field=Buffer_Distance.__str__().format(**locals(),**globals()))

    # Process: Pairwise Intersect (Pairwise Intersect) (analysis)
    Wells_In_Buffer = "D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer"
    arcpy.analysis.PairwiseIntersect(in_features=[Site_Buffer_Buffer_Distance_, Wells_Report], out_feature_class=Wells_In_Buffer)

    # Process: Export Table - Well_Type (Export Table) (conversion)
    Well_Type = "D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Well_Type"
    arcpy.conversion.ExportTable(in_table=Wells_In_Buffer, out_table=Well_Type, field_mapping="FID_Site_Buffer \"FID_Site_Buffer\" true true false 4 Long 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,FID_Site_Buffer,-1,-1;BUFF_DIST \"BUFF_DIST\" true true false 8 Double 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,BUFF_DIST,-1,-1;ORIG_FID \"ORIG_FID\" true true false 4 Long 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,ORIG_FID,-1,-1;FID_L1Wells_Report \"FID_L1Wells_Report\" true true false 4 Long 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,FID_L1Wells_Report,-1,-1;BORE_HOLE_ID \"BORE_HOLE_ID\" true true false 4 Long 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,BORE_HOLE_ID,-1,-1;WELL_ID \"WELL_ID\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,WELL_ID,0,255;WELL_COMPLETED_DATE \"WELL_COMPLETED_DATE\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,WELL_COMPLETED_DATE,0,255;RECEIVED_DATE \"RECEIVED_DATE\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,RECEIVED_DATE,0,255;AUDIT_NO \"AUDIT_NO\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,AUDIT_NO,0,255;TAG \"TAG\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,TAG,0,255;CONTRACTOR \"CONTRACTOR\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,CONTRACTOR,0,255;SWL \"SWL\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,SWL,0,255;FINAL_STATUS_DESCR \"FINAL_STATUS_DESCR\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,FINAL_STATUS_DESCR,0,255;USE1 \"USE1\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,USE1,0,255;USE2 \"USE2\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,USE2,0,255;MOE_COUNTY_DESCR \"MOE_COUNTY_DESCR\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,MOE_COUNTY_DESCR,0,255;MOE_MUNICIPALITY_DESCR \"MOE_MUNICIPALITY_DESCR\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,MOE_MUNICIPALITY_DESCR,0,255;CON \"CON\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,CON,0,255;LOT \"LOT\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,LOT,0,255;STREET \"STREET\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,STREET,0,255;CITY \"CITY\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,CITY,0,255;UTMZONE \"UTMZONE\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,UTMZONE,0,255;EAST83 \"EAST83\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,EAST83,0,255;NORTH83 \"NORTH83\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,NORTH83,0,255;GEO \"GEO\" true true false 3000 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,GEO,0,3000;PLUG \"PLUG\" true true false 1000 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,PLUG,0,1000;HOLE \"HOLE\" true true false 300 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,HOLE,0,300;CM \"CM\" true true false 300 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,CM,0,300;CAS \"CAS\" true true false 300 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,CAS,0,300;SCRN \"SCRN\" true true false 300 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,SCRN,0,300;WAT \"WAT\" true true false 300 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,WAT,0,300;PT \"PT\" true true false 300 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,PT,0,300;PTD \"PTD\" true true false 500 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,PTD,0,500;DISINFECTED \"DISINFECTED\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,DISINFECTED,0,255;BHK \"BHK\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,BHK,0,255;DEPTH_M \"DEPTH_M\" true true false 8 Double 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,DEPTH_M,-1,-1;PATH \"PATH\" true true false 255 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,PATH,0,255;COMPLETED_DATE \"COMPLETED_DATE\" true true false 4 Long 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,COMPLETED_DATE,-1,-1;COMPLETED_YEAR \"COMPLETED_YEAR\" true true false 4 Long 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,COMPLETED_YEAR,-1,-1;LOT_IDENT \"LOT_IDENT\" true true false 100 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,LOT_IDENT,0,100;CONCESSION_IDENT \"CONCESSION_IDENT\" true true false 100 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,CONCESSION_IDENT,0,100;GEOGRAPHIC_TOWNSHIP_NAME \"GEOGRAPHIC_TOWNSHIP_NAME\" true true false 100 Text 0 0,First,#,D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb\\Wells_In_Buffer,GEOGRAPHIC_TOWNSHIP_NAME,0,100", sort_field=[["WELL_ID", "ASCENDING"]])

    # Process: Calculate Field - WAT (Calculate Field) (management)
    Well_Type_2_ = arcpy.management.CalculateField(in_table=Well_Type, field="WAT", expression="primary(!WAT!)", code_block="""import re
def primary(waterField):
    def stephen_format(matchobj):
        val = float(matchobj[1])
        if matchobj[2] == \"ft\": 
            val=round((float(matchobj[1])*0.3048),2)
        return str(val) + \" m\" 
    waterField = re.findall('(\\w*;\\s*)([\\d\\.]+)\\s*(ft|m)', waterField)
    waterReturn = str()
    for m in waterField:
        stephen_format(m)
        waterReturn += stephen_format(m) + \"; \"
    return waterReturn""")[0]

    # Process: Calculate Field SWL (Calculate Field) (management)
    Well_Type_3_ = arcpy.management.CalculateField(in_table=Well_Type_2_, field="SWL", expression="statWater(!SWL!)", code_block="""import re
def statWater(waterField):
    def ft2m(conv):
        val = float(conv.group(1))
        if conv.group(2) == \" ft\": 
            val=round((float(conv.group(1))*0.3048),1)
            return str(val)
        elif conv.group(2) == \" m\":
            val = round(val,1)
            return str(val)
    converted = re.sub('([\\d\\.]+)(\\s*\\w+)',ft2m,waterField)
    return converted""")[0]

if __name__ == '__main__':
    # Global Environment settings
    with arcpy.EnvManager(scratchWorkspace="D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb", workspace="D:\\FlemSem3\\Collab\\CollabProj\\CollabProj.gdb"):
        Model(*argv[1:])
